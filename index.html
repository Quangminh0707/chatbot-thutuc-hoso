<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTHC_Chatbot - Hệ thống tra cứu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            display: flex;
            height: 100vh;
            background-color: #ffffff;
            overflow: hidden;
        }

        /* Sidebar bên trái */
        .sidebar {
            width: 260px;
            background-color: #f9f9f9;
            display: flex;
            flex-direction: column;
            padding: 15px;
            border-right: 1px solid #e5e5e5;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            color: #000;
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 5px;
            transition: background 0.2s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .sidebar-item:hover { background-color: #ececec; }
        .sidebar-item i { margin-right: 12px; width: 16px; text-align: center; }

        /* Vùng nội dung chính */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        /* Top Nav */
        .top-nav {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            height: 60px;
        }

        .brand-version { font-weight: 600; font-size: 18px; display: flex; align-items: center; }

        /* Khu vực hiển thị nội dung */
        .content-area {
            width: 100%;
            max-width: 800px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            text-align: center;
            overflow-y: auto;
        }

        /* Tiêu đề dự án nổi bật */
        .project-title {
            color: #1a73e8;
            font-size: 26px;
            font-weight: 800;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .sub-title {
            font-size: 16px;
            color: #444;
            margin-bottom: 15px;
        }

        .procedure-list {
            list-style: none;
            text-align: left;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #eee;
            line-height: 1.6;
            width: 90%;
            font-size: 14px;
        }

        .procedure-list li i {
            color: #1a73e8;
            margin-right: 10px;
        }

        /* Container chứa chatbot */
        #chatbot-container {
            width: 100%;
            max-width: 720px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* CSS ép khung chat của Dialogflow hiển thị cố định */
        df-messenger {
            --df-messenger-chat-window-height: 400px;
            --df-messenger-button-titlebar-color: #f4f4f4;
            --df-messenger-send-icon: #1a73e8;
            position: relative !important;
            width: 100% !important;
            z-index: 1;
        }

        /* Ẩn bong bóng launcher */
        df-messenger >>> .df-messenger-wrapper .launcher {
            display: none !important;
        }
        
        /* Hiển thị khung chat trực tiếp */
        df-messenger >>> df-messenger-chat {
            display: block !important;
            position: relative !important;
            height: 400px !important;
            border: 1px solid #ddd;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <i class="fa-solid fa-bars" style="cursor: pointer; color: #676767;"></i>
            <i class="fa-regular fa-pen-to-square" style="cursor: pointer; color: #676767;"></i>
        </div>
        
        <!-- Nút Đoạn chat mới có thêm sự kiện onclick -->
        <button class="sidebar-item" onclick="createNewChat()">
            <i class="fa-regular fa-message"></i> Đoạn chat mới
        </button>
        
        <button class="sidebar-item"><i class="fa-solid fa-magnifying-glass"></i> Tìm kiếm</button>
        <button class="sidebar-item"><i class="fa-regular fa-image"></i> Ảnh</button>
        <button class="sidebar-item"><i class="fa-solid fa-grid-2"></i> Ứng dụng</button>
    </aside>

    <main class="main-container">
        <header class="top-nav">
            <div class="brand-version">
                TTHC_Chatbot <i class="fa-solid fa-chevron-down" style="font-size: 12px; margin-left: 8px; color: #676767;"></i>
            </div>
            <div style="color: #676767; display: flex; gap: 15px;">
                <i class="fa-solid fa-user-plus"></i>
                <i class="fa-solid fa-circle-notch"></i>
            </div>
        </header>

        <div class="content-area">
            <h1 class="project-title">DỰ ÁN CHATBOT TRA CỨU TTHC ĐƠN GIẢN</h1>
            <p class="sub-title">Chatbot đã sẵn sàng. Hãy thử hỏi về 3 thủ tục:</p>
            
            <ul class="procedure-list">
                <li><i class="fa-solid fa-circle-check"></i> Quy định về Luật Hôn nhân & Gia đình</li>
                <li><i class="fa-solid fa-circle-check"></i> Quy định về Luật Căn cước mới nhất</li>
                <li><i class="fa-solid fa-circle-check"></i> Quy định về Luật Đất đai (Cấp lại sổ đỏ)</li>
            </ul>

            <!-- Container chứa Chatbot -->
            <div id="chatbot-container">
                <!-- Chatbot sẽ được chèn vào đây bởi script bên dưới -->
            </div>
        </div>
    </main>

    <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
    
    <script>
        // Hàm để tạo mới đoạn chat
        function createNewChat() {
            const container = document.getElementById('chatbot-container');
            
            // 1. Xóa bỏ chatbot cũ (nếu có)
            container.innerHTML = '';
            
            // 2. Tạo một thẻ df-messenger mới
            const newMessenger = document.createElement('df-messenger');
            
            // 3. Thiết lập các thông số (giống hệt agent của bạn)
            newMessenger.setAttribute('intent', 'WELCOME');
            newMessenger.setAttribute('chat-title', 'TTHC_Chatbot_KHKT');
            newMessenger.setAttribute('agent-id', 'beb30889-a174-4fd7-b494-b2a3fe16a795');
            newMessenger.setAttribute('language-code', 'vi');
            newMessenger.setAttribute('expand', 'true'); // Tự động mở khung chat
            
            // 4. Chèn vào container
            container.appendChild(newMessenger);
        }

        // Tự động gọi hàm tạo chat khi trang vừa load xong lần đầu
        window.onload = createNewChat;
    </script>

</body>
</html>
